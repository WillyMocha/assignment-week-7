<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        
        
        <!-- Bootstrap core CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

        <link name="font-awesome" rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css" />
        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,300;0,400;0,600;0,700;0,900;1,300;1,400;1,600;1,700;1,900&amp;display=swap" rel="stylesheet">

        <title>Recruitment Form</title>

        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body class="scrollbar">
        <nav>
            <a href="https://neuronworks.co.id" class="link1">
                <img src="img/nw-horizontal.png"  alt="PT. Neuronworks Indonesia" class="logo1">
            </a>
        </nav>
        <div>
            <img src="img/Starlid-illustration.png"  alt="PT. Neuronworks Indonesia" class="starlid" >
            <form id="formRecuit">
                <div>
                    <div class="logo2">
                        <img src="img/logomark-sign.png" alt="Neuron 3.0" class="logo2">
                    </div>
                </div>
                <div class="form-description">
                    <h3 class="form-title">Form Rekrutasi</h3>
                    <p class="caption">Isi data di bawah sesuai dengan identitas diri anda dan lowongan yang akan anda pilih</p>
                </div>
                <div>
                    <label for="fullname">Fullname<span class="redstar">*</span></label>
                    <input type="text" class="form-control" name="fullname" id="fullname" placeholder="Masukkan nama">
                    <h6 id="alert0"></h6>
                </div>
                
                <div>
                    <label for="email">Email<span class="redstar">*</span></label>
                    <input type="text" class="form-control" name="email" id="email" placeholder="Masukkan email">
                    <h6 id="alert1" class="redstar"></h6>
                </div>
                
                <div>
                    <label for="phone">Phone Number<span class="redstar">*</span></label>
                    <input type="number" class="form-control" name="phone" id="phone" placeholder="Masukkan nomor telpon">
                    <h6 id="alert2"></h6>
                </div>
                
                <div>
                    <label for="vacancy">Vacancy<span class="redstar">*</span></label>
                    <select class="form-control" name="lowongan" id="lowongan">
                    </select>
                    <h6 id="alert3"></h6>
                </div>
                
                <div>
                    <label for="position">Position <span class="redstar">*</span></label>
                    <select class="form-control" name="posisi" id="posisi">
                    </select>
                    <h6 id="alert4"></h6>
                </div>
                <div class="d-grid">
                    <button class="btn btn-primary waves-effect waves-light" type="button" id="btnSubmit" onclick="submitForm()">Kirim</button>
                </div>
                <div>
                    <ul>
                        <li>
                            <a href="https://instagram.com/neuronworks">
                                <i class="fab fa-instagram-square sosmed" aria-hidden="true"></i>
                            </a>                        
                        </li>
                        <li>
                            <a href="https://www.youtube.com/@NeuronworksIndonesia">
                                <i class="fab fa-youtube sosmed" aria-hidden="true"></i>
                                <span class="sr-only">Youtube</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://twitter.com/neuronworks">
                                <i class="fab fa-twitter sosmed" aria-hidden="true"></i>
                                <span class="sr-only">Twitter</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.facebook.com/neuronworks/">
                                <i class="fab fa-facebook sosmed" aria-hidden="true"></i>
                                <span class="sr-only">Facebook</span>
                            </a>
                        </li>
                    </ul>
                    <a class="neuronlink" href="https://www.neuronworks.co.id">www.neuronworks.co.id</a>
                </div>         
            </form>
        </div>
        
        <!-- Modal -->
        <div class="modal fade" id="modalSubmit" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalSubmitLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="modalSubmitLabel"></h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <h6 id="info"></h6>
                        <div id="modalContent"></div>
                        <span id="total"></span>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onClick="window.location.reload();">Okay</button>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

        <script>

            if(localStorage.getItem("sa") == "" || localStorage.getItem("sa") == null){
                localStorage.setItem("sa", 1);
            }

            if(localStorage.getItem("dev") == "" || localStorage.getItem("dev") == null){
                localStorage.setItem("dev", 2);
            }

            if(localStorage.getItem("tw") == "" || localStorage.getItem("tw") == null){
                localStorage.setItem("tw", 3);
            }

            if(localStorage.getItem("submiter") == "" || localStorage.getItem("submiter") == null){
                localStorage.setItem("submiter", 0);
            }

            if(localStorage.getItem("fullname") == "" || localStorage.getItem("fullname") == null){
                var arrName = new Array;
            }else{
                var arrName = JSON.parse(localStorage["fullname"]);
            }

            if(localStorage.getItem("email") == "" || localStorage.getItem("email") == null){
                var arrEmail = new Array;
            }else{
                var arrEmail = JSON.parse(localStorage["email"]);
            }

            if(localStorage.getItem("phone") == "" || localStorage.getItem("phone") == null){
                var arrPhone = new Array;
            }else{
                var arrPhone = JSON.parse(localStorage["phone"]);
            }

            if(localStorage.getItem("lowongan") == "" || localStorage.getItem("lowongan") == null){
                var arrLowongan = new Array;
            }else{
                var arrLowongan = JSON.parse(localStorage["lowongan"]);
            }

            if(localStorage.getItem("posisi") == "" || localStorage.getItem("posisi") == null){
                var arrPosisi = new Array;
            }else{
                var arrPosisi = JSON.parse(localStorage["posisi"]);
            }

            var sa = parseInt(localStorage.getItem("sa")),
            dev = parseInt(localStorage.getItem("dev")),
            tw = parseInt(localStorage.getItem("tw")),
            submiter = parseInt(localStorage.getItem("submiter")),
            selectLowongan = $('#lowongan')[0],
            selectPosisi = $('#posisi')[0];
            
            const lowongan = ["- Pilih Lowongan -", "System Adminintrator", "Programmer", "Technical Writter"],
            posisi = ["- Pilih Posisi -", "Bandung", "Jakarta"];

            for (var i = 0; i<lowongan.length; i++){
                var opt = document.createElement('option');
                opt.value = lowongan[i];
                opt.innerHTML = lowongan[i];
                selectLowongan.appendChild(opt);
            }

            for (var i = 0; i<posisi.length; i++){
                var opt = document.createElement('option');
                opt.value = posisi[i];
                opt.innerHTML = posisi[i];
                selectPosisi.appendChild(opt);
            }

            $('#lowongan').on('change', function() {

                var valueLowongan = this.value;
                
                //Validasi lowongan
                validateLowongan(valueLowongan);

            });

            $('#posisi').on('change', function() {
                var valuePosisi = this.value;
            });

            function submitForm(){

                var fullname = $('#fullname').val(),
                email = $('#email').val(),
                phone = $('#phone').val(),
                x = $('#lowongan').val(),
                y = $('#posisi').val(),
                lowongan = (x.includes("Pilih")) ? '' : x,
                posisi = (y.includes("Pilih")) ? '' : y,
                getEmail = localStorage.getItem("email"),
                getPhone = localStorage.getItem("phone"),
                countLowongan = 0;

                const data = [fullname, email, phone, lowongan, posisi];

                //Validasi inputan
                for(var i=0; i<data.length; i++){
                    $('#alert'+i).empty();
                    var validateInput = validateForm(data[i]);

                    if (validateInput != 0){
                        $('#alert3').removeClass("yellow-alert green-alert");
                        $('#alert'+i).append(validateInput);
                        $('#alert'+i).addClass("redstar");
                    }
                }

                if(validateInput == 0){

                    //Validasi email
                    var valEmail = validateEmail(getEmail, email);

                    //Validasi no.hp
                    var valPhone = validatePhone(getPhone, phone);

                    if(valEmail == 0 && valPhone == 0){
                        switch(lowongan) {
                            case "System Adminintrator":
                                countLowongan = sa-1;
                                localStorage.setItem("sa", countLowongan);
                                break;
                            case "Programmer":
                                countLowongan = dev-1;
                                localStorage.setItem("dev", countLowongan);
                                break;
                            default:
                                countLowongan = tw-1;
                                localStorage.setItem("tw", countLowongan);
                        }

                        setLocal(data);
                        var total = localStorage.getItem("submiter");

                        $('#modalContent').empty();
                        $("#modalSubmitLabel").text("Success");
                        $("#info").text("Terimakasih telah melakukan pengisian, permintaan anda akan segera kami proses.");
                        $("#info").css('color', '#198754');
                        $("#total").text("Jumlah Pendaftar "+total+" orang.");

                        var content = '<span class="badge text-bg-secondary">Fullname</span> <h6>'+fullname+'</h6><span class="badge text-bg-secondary">Email</span> <h6>'+email+'</h6><span class="badge text-bg-secondary">Phone</span> <h6>'+phone+'</h6><span class="badge text-bg-secondary">Lowongan</span> <h6>'+lowongan+'</h6><span class="badge text-bg-secondary">Posisi</span> <h6>'+posisi+'</h6>';
                        $('#modalContent').append(content);

                        $('#modalSubmit').modal('show');
                    }
                }

            }

            function validateLowongan(data){
                
                switch(data) {
                    case "System Adminintrator":
                        if(sa == 0){
                            $('#alert3').empty();
                            $('#alert3').removeClass("yellow-alert green-alert");
                            $('#alert3').append("Mohon maaf, rekrutasi untuk " +data+ " sudah penuh, dan tidak dapat dipilih.");
                            $('#alert3').addClass("redstar");
                        }else if(sa <= 2){
                            $('#alert3').empty();
                            $('#alert3').removeClass("redstar green-alert");
                            $('#alert3').append("Kuota tersisa untuk " +data+ " hanya 2 pendaftar.");
                            $('#alert3').addClass("yellow-alert");
                        }else{
                            $('#alert3').empty();
                            $('#alert3').removeClass("redstar yellow-alert");
                            $('#alert3').append("Anda dapat memilih lowongan " +data+ ".");
                            $('#alert3').addClass("green-alert");
                        }
                        break;
                    case "Programmer":
                        if(dev == 0){
                            $('#alert3').empty();
                            $('#alert3').removeClass("yellow-alert green-alert");
                            $('#alert3').append("Mohon maaf, rekrutasi untuk " +data+ " sudah penuh, dan tidak dapat dipilih.");
                            $('#alert3').addClass("redstar");
                        }else if(dev <= 2){
                            $('#alert3').empty();
                            $('#alert3').removeClass("redstar green-alert");
                            $('#alert3').append("Kuota tersisa untuk " +data+ " hanya 2 pendaftar.");
                            $('#alert3').addClass("yellow-alert");
                        }else{
                            $('#alert3').empty();
                            $('#alert3').removeClass("redstar yellow-alert");
                            $('#alert3').append("Anda dapat memilih lowongan " +data+ ".");
                            $('#alert3').addClass("green-alert");
                        }
                        break;
                    case "Technical Writter":
                        if(tw == 0){
                            $('#alert3').empty();
                            $('#alert3').removeClass("yellow-alert green-alert");
                            $('#alert3').append("Mohon maaf, rekrutasi untuk " +data+ " sudah penuh, dan tidak dapat dipilih.");
                            $('#alert3').addClass("redstar");
                        }else if(tw <= 2){
                            $('#alert3').empty();
                            $('#alert3').removeClass("redstar green-alert");
                            $('#alert3').append("Kuota tersisa untuk " +data+ " hanya 2 pendaftar.");
                            $('#alert3').addClass("yellow-alert");
                        }else{
                            $('#alert3').empty();
                            $('#alert3').removeClass("redstar yellow-alert");
                            $('#alert3').append("Anda dapat memilih lowongan " +data+ ".");
                            $('#alert3').addClass("green-alert");
                        }
                        break;
                    default:
                        $('#alert3').empty();
                        $('#alert3').removeClass("yellow-alert green-alert");
                        $('#alert3').append("Tidak boleh kosong");
                        $('#alert3').addClass("redstar");
                        break;
                }
            }
            
            function validateForm(data) {
                if (data == "" || data == null) {
                    return "Tidak boleh kosong";
                }else{
                    return 0;
                }
            }

            function validateEmail(data, key) {
                if(data != null){

                    var valEmail = JSON.parse(localStorage["email"]);

                    for(var i=0; i<valEmail.length; i++){
                        
                        if(valEmail[i] === key){
                            $('#alert1').empty();
                            $('#alert1').append('Email sudah pernah disubmit');

                            return 1;
                        }else{
                            $('#alert1').empty();

                            return 0;
                        }
                    }
                }else{
                    return 0;
                }
            }

            function validatePhone(data, key) {
                if(data != null){
                    
                    var valPhone = JSON.parse(localStorage["phone"]);

                    for(var i=0; i<valPhone.length; i++){
                        
                        if(valPhone[i] === key){
                            $('#alert2').empty();
                            $('#alert2').append('No. HP sudah pernah disubmit');

                            return 1;
                        }else{
                            $('#alert2').empty();

                            return 0;
                        }
                    }
                }else{
                    return 0;
                }
            }

            function setLocal(data) {

                arrName.push(data[0]);
                arrEmail.push(data[1]);
                arrPhone.push(data[2]);
                arrLowongan.push(data[3]);
                arrPosisi.push(data[4]);

                localStorage["fullname"] = JSON.stringify(arrName);
                localStorage["email"] = JSON.stringify(arrEmail);
                localStorage["phone"] = JSON.stringify(arrPhone);
                localStorage["lowongan"] = JSON.stringify(arrLowongan);
                localStorage["posisi"] = JSON.stringify(arrPosisi);
                localStorage.setItem("submiter", ++submiter);

            }

        </script>
    </body>
</html>